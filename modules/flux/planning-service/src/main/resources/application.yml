spring:
  application:
    name: planning-service
  profiles:
    active: default
  datasource:
    url: jdbc:postgresql://localhost:5434/vt_planning_service
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        # Batch insert optimization for high-volume scenarios (thousands of orders per day)
        jdbc:
          batch_size: 50
          order_inserts: true
          order_updates: true
  kafka:
    bootstrap-servers: localhost:9094
    consumer:
      group-id: planning-service-group
      auto-offset-reset: earliest
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
  # Mail Configuration (for Magic Link emails)
  # Uses MailHog in development (localhost:8025)
  # Configure with SendGrid/AWS SES for production
  mail:
    host: localhost
    port: 1025  # MailHog SMTP port
    username: noreply@voidtracker.app
    password: password
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: false

server:
  port: 8093

# Gatekeeper Configuration
gatekeeper:
  enabled: true
  score-threshold-percent: 20.0
  n8n:
    webhook:
      url: http://localhost:5678/webhook/gatekeeper

# Auto-Plan Configuration
auto-plan:
  enabled: true
  min-batch-size: 10
  max-batch-size: 1000
  batch-schedules:
    - "0 0 22 * * *"  # 22:00 ka≈ºdego dnia
  batch-timeout-minutes: 10
  urgent:
    auto-reoptimize: true
    timeout-seconds: 30
    require-manual-approval: true
  sla:
    warning-hours-before-deadline: 2
    critical-hours-before-deadline: 1
    check-frequency-minutes: 15
    customer-email-enabled: true
    customer-sms-enabled: false

# Media Upload Configuration
media:
  upload:
    directory: ./uploads  # Local filesystem storage (change to S3 bucket for production)
    max-size: 10485760    # 10MB max file size

# IAM Service Configuration
application:
  config:
    iam-service-url: http://localhost:8090

# Logging
logging:
  level:
    com.example.planning_service: INFO
    org.springframework.web: INFO
    ai.timefold.solver: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
